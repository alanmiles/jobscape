<div class = "r-float">
  <%= link_to "Menu for this business", officer_home_path %><br />
  <%= link_to "Add a new department", new_business_department_path(@department) %>
</div>

<h1>Departments</h1>
<h4><%= @business.name %></h4>

<% unless @departments.empty? %>
  <%= will_paginate @departments %>
  <table class="smaller_font">
    <tr>
      <th>Name</th>
      <th>Head</th>
      <th>Deputy</th>
      <th class="centralize">Team</th>
      <th class="centralize">Job-titles</th>
      <th></th>
      <th></th>
    </tr>
    <% @departments.each do |department| %>
    <tr>
      <td><%= link_to department.name, department %>
      <td><%= department.manager.name unless department.manager_id == nil %> </td>
      <td><%= department.deputy.name unless department.deputy_id == nil %> </td>
      <td class="centralize">
        <%= department.headcount %>
      </td>
      <td class="centralize">
        <%= department.position_count %>
      </td>
      <td class="centralize">
        <%= link_to image_tag("select.png", :size => "15x15"), department %>
      </td>
      <td class = "control">
        <% unless department.has_active_jobs? %>
          
          <% if department.has_inactive_jobs? %>
            <%= link_to image_tag("cancel.png", :size => "15x15"), department, 
                   :method => :delete, 
                   :confirm => "Are you sure you want to exclude #{department.name} from the current departments list?",
                   :title => "Remove #{department.name} from the list of current departments" %>
          
          <% else %>
            <%= link_to image_tag("cancel.png", :size => "15x15"), department, 
                   :method => :delete, 
                   :confirm => "Are you sure you want to delete #{department.name} completely?",
                   :title => "Delete #{department.name} completely" %>
          <% end %>
          
        <% end %>
      </td> 
    </tr>
    <% end %>
  </table>
  <%= will_paginate @departments %>
<% else %>
  <div class="no_data round">
    You haven't added any departments yet.  You need to - because jobs will be linked to their departments.
  </div>
<% end %>
